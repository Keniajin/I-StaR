---
title: "Introduction to ggplot2"
author: "Alice Kamau| Ken Mwai | Mark Otiende"
date: "7/5/2021"
output: 
  slidy_presentation: default
  beamer_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      tidy = TRUE,
      tidy.opts=list(blank=FALSE, width.cutoff=60,size = 'tiny'),
      fig.width=10, 
      fig.height=8)
library(ggplot2)
```

## Learning objectives

- Produce scatter plots, boxplots, and time series plots using ggplot.

- Set universal plot settings.

- Describe what faceting is and apply faceting in ggplot.

- Modify the aesthetics of an existing ggplot plot (including axis labels and color).

- Build complex and customized plots from data in a data frame.

- Load ggplot2

```{r , eval=FALSE}
# Installation - 
# install.packages('ggplot2')
# Loading
library(ggplot2)
```

- Set the directory

```{r, eval=FALSE}
setwd("/Users/akamau/Desktop/R training/I-StaR")
```

- Load the data

```{r}
bw_df <- read.csv("Course 1/Day4/Data/birthweight2.csv")
names(bw_df)
```


## Why?

- To have an understanding of you data we normally conduct exploratory data analysis (EDA) which can be graphical or numerical

 - Primarily EDA is for seeing what the data can tell us before the formal modelling or hypothesis testing task

- Typical graphical techniques used in EDA are:
  - Scatter plots,
  - Box plots,
  - Bar plots
  
  
## Scatter with base R

```{r, echo=TRUE}
plot(bw_df$gestwks, bw_df$bweight)
```


##  Scatter plot with ggplot2

```{r}
#declare data and x and y aesthetics, 
#but no shapes yet
ggplot(data = bw_df ) +
  geom_point(mapping=aes(x=gestwks, y=bweight))
```


```{r}
# adding aesthetics
ggplot(data = bw_df) +
  geom_point(mapping = aes(x=gestwks, y=bweight , color=sex ))
```


## Boxplot

- Provides a standardized way of displaying the distribution of data

- It attempts to provide a visual shape of the data distribution.

- This is based on some summary measures: min, $1^{st}$ quartile, median, $3^{rd}$ quartile, max

- Range, IQR, Outliers - 3 $\times$ IQR above $3^{rd}$ or below $1^{st}$ quartiles.

![](images/box1.png)

## Lets do a Box plot?

 - A box plot of bweight vs sex
 
```{r}
ggplot(data = bw_df)
```


***

```{r}
ggplot(data = bw_df) +
  geom_boxplot(aes(y=bweight, x=sex, fill=sex)) + ylab("B Weight") + 
  xlab("Sex") + ggtitle("B weight vs Sex")
```


## Box plot and add scatter

```{r}
ggplot(data = bw_df, mapping=aes(y=bweight, x=sex,fill=sex)) +
   geom_boxplot() + geom_point()+
  #geom_jitter() + #geom_violin() +
  ylab("Birth Weight") + xlab("Sex") + 
  ggtitle("Birth weight vs Sex") 
```


## Putting it all together

- We can build a plot sequentially to see how each grammatical layer changes the appearance  

##

```{r, echo=FALSE}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point() +
##Add a smooth geom
  #geom_smooth() +
##Make it straight
  geom_smooth(method = "lm") +
#Facet by sex
  facet_wrap(vars(sex), ncol = 2) +
## add labels
    labs(x = "Gestation weeks", y = "Birthweight",
       color = "Sex",
       title = "Lower gestation weeks leads to low birthweight",
       subtitle = "Birth weight is in grams",
       caption = "Is there something we can observe by gender") +
  #Add a theme
  theme_bw()
```


## Start with data and aesthetics

```{r}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex))
```


## Add a point geom

```{r}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point()
```


## Add a smooth geom

```{r}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point() +
##Add a smooth geom
  geom_smooth()
```


## Make the smooth geom straight

```{r}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point() +
##Add a smooth geom
  #geom_smooth() +
##Make it straight
  geom_smooth(method = "lm")
```


## Facet by sex


```{r}
  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point() +
##Add a smooth geom
  #geom_smooth() +
##Make it straight
  geom_smooth(method = "lm") +
#Facet by sex
  facet_wrap(vars(sex), ncol = 2)
```

## add labels

```{r}

  #Start with data and aesthetics
ggplot(data = bw_df ,
       mapping = aes(x = gestwks,
                     y = bweight,
                     color = sex)) +
#Add a point geom
  geom_point() +
##Add a smooth geom
  #geom_smooth() +
##Make it straight
  geom_smooth(method = "lm") +
#Facet by sex
  facet_wrap(vars(sex), ncol = 2) +
## add labels
    labs(x = "Gestation weeks", y = "Birthweight",
       color = "Sex",
       title = "Lower gestation weeks leads to low birthweight",
       subtitle = "Birth weight is in grams",
       caption = "Is there something we can observe by gender")

```


## Themes 

https://ggplot2.tidyverse.org/reference/ggtheme.html


## Other types of graphs

http://www.sthda.com/english/wiki/be-awesome-in-ggplot2-a-practical-guide-to-be-highly-effective-r-software-and-data-visualization


https://www.data-to-viz.com/

